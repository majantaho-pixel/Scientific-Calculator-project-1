const server = document.getElementById("serverSelect").value;

// Fetch ping & download from backend
const data = await fetch(`http://localhost:3000/api/speedtest?server=${server}`)
    .then(r => r.json());

downloadBox.innerText = data.download;
pingBox.innerText = data.ping;
updateGraph(data.download);

// Upload test
const uploadData = new Uint8Array(2*1024*1024);
const uploadResult = await fetch('http://localhost:3000/api/upload', {
  method:'POST',
  body: uploadData
}).then(r => r.json());

uploadBox.innerText = uploadResult.upload;
updateGraph(uploadResult.upload);

// Optional: Voice output
speakResult(`Download ${data.download} Mbps, Upload ${uploadResult.upload} Mbps`);
