<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Velocity Gaming Speed Test</title>
<link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700&display=swap" rel="stylesheet">
<style>
:root {
  --bg-color: #0a0a0a;
  --accent-color: #00ffea;
  --text-color: #ffffff;
  --card-bg: rgba(20,20,30,0.8);
  --button-bg: linear-gradient(45deg,#00ffea,#0077ff);
  --button-hover: linear-gradient(45deg,#00ffaa,#00ccff);
}
[data-theme="light"] {
  --bg-color:#f5f5f5;
  --text-color:#0a0a0a;
  --card-bg:rgba(255,255,255,0.9);
  --button-bg:linear-gradient(45deg,#0077ff,#00aaff);
  --button-hover:linear-gradient(45deg,#0055ff,#00ccff);
}

*{box-sizing:border-box;margin:0;padding:0;font-family:'Orbitron',sans-serif;}

body{
  background: var(--bg-color);
  color: var(--text-color);
  display:flex;
  flex-direction:column;
  align-items:center;
  min-height:100vh;
  overflow-x:hidden;
}

header{
  width:100%;
  padding:15px 20px;
  display:flex;
  justify-content:space-between;
  align-items:center;
  backdrop-filter:blur(10px);
  background: rgba(0,0,0,0.4);
  box-shadow:0 0 20px var(--accent-color);
  border-bottom:1px solid var(--accent-color);
}

header h1{
  font-size:1.8rem;
  color: var(--accent-color);
  text-shadow:0 0 10px var(--accent-color);
}

#themeToggle{
  padding:8px 14px;
  border:2px solid var(--accent-color);
  background:none;
  color:var(--accent-color);
  border-radius:12px;
  cursor:pointer;
  font-weight:bold;
  transition:0.3s;
}
#themeToggle:hover{
  background: var(--accent-color);
  color:#000;
  box-shadow:0 0 20px var(--accent-color);
}

main{
  padding:30px 20px;
  width:100%;
  max-width:1000px;
}

.gauges{
  display:flex;
  flex-wrap:wrap;
  justify-content:space-around;
  margin-bottom:30px;
}

.gauge-container{
  background: var(--card-bg);
  border-radius:20px;
  box-shadow:0 0 20px var(--accent-color);
  padding:20px;
  text-align:center;
  margin:15px;
  width:220px;
  transition:0.3s;
}
.gauge-container:hover{
  box-shadow:0 0 40px var(--accent-color);
}

canvas{
  background:#111;
  border-radius:50%;
  box-shadow:0 0 15px var(--accent-color);
}

.gauge-container p{
  margin-top:15px;
  font-size:1.1rem;
  font-weight:bold;
  color: var(--accent-color);
  text-shadow:0 0 10px var(--accent-color);
}

.info{
  display:flex;
  flex-wrap:wrap;
  justify-content:space-around;
  margin-bottom:30px;
}

.info div{
  background: var(--card-bg);
  padding:12px 18px;
  border-radius:15px;
  min-width:140px;
  text-align:center;
  box-shadow:0 0 15px var(--accent-color);
  transition:0.3s;
}
.info div:hover{
  box-shadow:0 0 25px var(--accent-color);
}

#serverSelect{
  padding:8px 12px;
  border-radius:10px;
  border:1px solid var(--accent-color);
  margin-bottom:25px;
  background: var(--card-bg);
  color: var(--text-color);
}

#startBtn{
  padding:12px 25px;
  font-size:1.2rem;
  border:none;
  border-radius:15px;
  cursor:pointer;
  background: var(--button-bg);
  color:#000;
  box-shadow:0 0 25px var(--accent-color);
  margin-bottom:20px;
  transition:0.3s;
}
#startBtn:hover{
  background: var(--button-hover);
  transform:scale(1.05);
  box-shadow:0 0 50px var(--accent-color);
}

#results{
  text-align:center;
}
#results button{
  margin-top:12px;
  padding:10px 16px;
  cursor:pointer;
  border:none;
  border-radius:12px;
  background: var(--button-bg);
  color:#000;
  box-shadow:0 0 25px var(--accent-color);
  transition:0.3s;
}
#results button:hover{
  background: var(--button-hover);
  box-shadow:0 0 50px var(--accent-color);
}

footer{
  width:100%;
  padding:20px;
  text-align:center;
  margin-top:auto;
  backdrop-filter:blur(10px);
  background: rgba(0,0,0,0.3);
  box-shadow:0 -2px 20px var(--accent-color);
  border-top:1px solid var(--accent-color);
}
#ads{
  margin-top:10px;
  height:70px;
  line-height:70px;
  color:var(--accent-color);
  font-weight:bold;
  text-shadow:0 0 10px var(--accent-color);
  background: rgba(255,255,255,0.05);
  border-radius:15px;
}

@media(max-width:768px){
  .gauges{flex-direction:column; align-items:center;}
  .gauge-container{width:80%;}
  .info div{width:80%; margin:10px auto;}
}
</style>
</head>
<body data-theme="dark">

<header>
  <h1>Velocity Test</h1>
  <button id="themeToggle">Toggle Theme</button>
</header>

<main>
  <div class="gauges">
    <div class="gauge-container">
      <canvas id="downloadGauge" width="200" height="200"></canvas>
      <p>Download <span id="downloadSpeed">0</span> Mbps</p>
    </div>
    <div class="gauge-container">
      <canvas id="uploadGauge" width="200" height="200"></canvas>
      <p>Upload <span id="uploadSpeed">0</span> Mbps</p>
    </div>
  </div>

  <div class="info">
    <div>Ping: <span id="ping">0</span> ms</div>
    <div>Jitter: <span id="jitter">0</span> ms</div>
    <div>IP: <span id="ip">-</span></div>
    <div>Location: <span id="location">-</span></div>
    <div>ISP: <span id="isp">-</span></div>
  </div>

  <select id="serverSelect"></select>
  <br>
  <button id="startBtn">Start Test</button>

  <div id="results">
    <button id="shareBtn">Share Result Image</button>
  </div>
</main>

<footer>
  <div>Â© 2025 Velocity Test</div>
  <div id="ads">Ads Space</div>
</footer>

<script src="https://cdn.jsdelivr.net/npm/html2canvas@1.4.1/dist/html2canvas.min.js"></script>
<script>
// Theme toggle
const themeBtn = document.getElementById('themeToggle');
themeBtn.addEventListener('click', () => {
  const current = document.body.getAttribute('data-theme');
  document.body.setAttribute('data-theme', current==='dark'?'light':'dark');
});

// Server List
const servers = [
  {name:"Pakistan Server", url:"https://speedtest.pk/speedtest/upload.php"},
  {name:"US Server", url:"https://speedtest.tele2.net/upload.php"},
  {name:"Germany Server", url:"https://speedtest.tele2.net/upload.php"},
];
const serverSelect = document.getElementById('serverSelect');
servers.forEach((s,i)=>{
  const opt = document.createElement('option');
  opt.value=i;
  opt.textContent=s.name;
  serverSelect.appendChild(opt);
});

// Gauges
const downloadCanvas = document.getElementById('downloadGauge');
const uploadCanvas = document.getElementById('uploadGauge');
const dctx = downloadCanvas.getContext('2d');
const uctx = uploadCanvas.getContext('2d');

function drawGauge(ctx, percent, color){
  const radius = ctx.canvas.width/2 -10;
  ctx.clearRect(0,0,ctx.canvas.width,ctx.canvas.height);
  ctx.beginPath();
  ctx.arc(ctx.canvas.width/2, ctx.canvas.height/2, radius, 0, 2*Math.PI);
  ctx.fillStyle = getComputedStyle(document.body).getPropertyValue('--card-bg');
  ctx.fill();

  ctx.beginPath();
  ctx.arc(ctx.canvas.width/2, ctx.canvas.height/2, radius, -Math.PI/2, -Math.PI/2 + 2*Math.PI*percent/100);
  ctx.strokeStyle = color;
  ctx.lineWidth = 12;
  ctx.shadowBlur=15;
  ctx.shadowColor=color;
  ctx.stroke();
}

function animateGauge(ctx, target, id, color){
  let val = 0;
  const step = target/50;
  const interval = setInterval(()=>{
    if(val >= target) { clearInterval(interval); val = target; }
    drawGauge(ctx, val, color);
    document.getElementById(id).textContent = val.toFixed(2);
    val += step;
  },20);
}

// IP + Location + ISP
async function fetchIPInfo(){
  try{
    const res = await fetch('https://ipapi.co/json/');
    const data = await res.json();
    document.getElementById('ip').textContent = data.ip;
    document.getElementById('location').textContent = data.city + ", " + data.country_name;
    document.getElementById('isp').textContent = data.org;
  }catch(e){
    console.log("IP info error",e);
  }
}

// Dummy Free Speed Test (simulate)
function runTest(){
  const server = servers[serverSelect.value];
  document.getElementById('startBtn').disabled = true;

  // Ping & Jitter
  const ping = (Math.random()*50+10).toFixed(0);
  const jitter = (Math.random()*20+5).toFixed(0);
  document.getElementById('ping').textContent = ping;
  document.getElementById('jitter').textContent = jitter;

  // Download & Upload
  const download = (Math.random()*90+10).toFixed(2);
  const upload = (Math.random()*50+5).toFixed(2);
  animateGauge(dctx, download, 'downloadSpeed', getComputedStyle(document.body).getPropertyValue('--accent-color'));
  animateGauge(uctx, upload, 'uploadSpeed', getComputedStyle(document.body).getPropertyValue('--accent-color'));

  // Save history
  let history = JSON.parse(localStorage.getItem('speedHistory')||"[]");
  history.unshift({
    date: new Date().toLocaleString(),
    download, upload, ping, jitter,
    ip:document.getElementById('ip').textContent,
    location:document.getElementById('location').textContent,
    isp:document.getElementById('isp').textContent
  });
  if(history.length>10) history.pop();
  localStorage.setItem('speedHistory', JSON.stringify(history));

  document.getElementById('startBtn').disabled = false;
}

document.getElementById('startBtn').addEventListener('click', ()=>{
  fetchIPInfo();
  runTest();
});

// Share Result Image
document.getElementById('shareBtn').addEventListener('click', ()=>{
  html2canvas(document.querySelector('main')).then(canvas=>{
    const link = document.createElement('a');
    link.download = 'speed-test.png';
    link.href = canvas.toDataURL();
    link.click();
  });
});
</script>
</body>
</html>
