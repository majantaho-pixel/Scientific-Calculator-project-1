<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>EasyCalc Pro â€” Scientific + BMI</title>
<style>
:root{
  --bg: linear-gradient(180deg,#f4f7fb,#e8eef8);
  --panel: #fff;
  --text:#0b1220;
  --accent:#ff6b35;
  --muted:#556;
}
body.dark{
  --bg: linear-gradient(180deg,#061022,#07102a);
  --panel: rgba(20,24,36,0.9);
  --text: #e6eef8;
  --accent:#60a5fa;
  --muted:#9aa7bf;
}
*{box-sizing:border-box;}
body{margin:0;font-family:sans-serif;background:var(--bg);color:var(--text);}
.page{max-width:600px;margin:auto;padding:10px;}
header{display:flex;justify-content:space-between;align-items:center;margin-bottom:10px;}
.brand{font-weight:800;font-size:22px;color:var(--accent);}
button{padding:10px;border:none;border-radius:8px;cursor:pointer;font-weight:700;}
button.small{padding:5px;font-size:14px;}
.display-small, .display-big{width:100%;border-radius:10px;margin-bottom:8px;padding:8px;display:flex;justify-content:flex-end;align-items:center;}
.display-small{height:40px;background:rgba(0,0,0,0.05);}
.display-big{height:70px;background:rgba(0,0,0,0.08);font-size:26px;font-weight:700;}
.keys{display:grid;grid-template-columns:repeat(6,1fr);gap:6px;margin-top:10px;}
.key{background:var(--panel);color:var(--text);}
.key.op{background:var(--accent);color:#fff;}
.key.sc{background:#3b82f6;color:#fff;}
.key.wide{grid-column:span 2;}
.history{max-height:120px;overflow:auto;font-size:13px;color:var(--muted);}
.bmi-grid{display:grid;grid-template-columns:1fr 1fr;gap:8px;margin-top:8px;}
input,select{width:100%;padding:8px;border-radius:6px;border:none;background:rgba(255,255,255,0.1);color:var(--text);}
.bmi-bar{height:14px;background:rgba(0,0,0,0.06);border-radius:10px;overflow:hidden;margin-top:8px;}
.bmi-fill{height:100%;width:0%;background:linear-gradient(90deg,#34d399,#f59e0b);transition:width 0.8s;}
footer{text-align:center;font-size:13px;color:var(--muted);margin-top:15px;}
@media(max-width:780px){.keys{grid-template-columns:repeat(4,1fr);}.display-big{font-size:22px;height:60px;}.bmi-grid{grid-template-columns:1fr;}}
@media(max-width:480px){.keys{grid-template-columns:repeat(3,1fr);}.display-big{font-size:20px;height:50px;}}
</style>
</head>
<body>
<div class="page">
<header>
  <div class="brand">EasyCalc Pro</div>
  <div>
    <button id="themeToggle" class="small">ðŸŒ™</button>
  </div>
</header>

<!-- Small & Big display -->
<div class="display-small" id="smallInput"><span id="smallExpr">&nbsp;</span></div>
<div class="display-big" id="bigOutput"><span id="bigVal">0</span></div>

<!-- Calculator keys -->
<div class="keys">
  <button class="key" data-key="MC">MC</button>
  <button class="key" data-key="MR">MR</button>
  <button class="key" data-key="M+">M+</button>
  <button class="key" data-key="M-">M-</button>
  <button class="key sc" data-key="sqrt">âˆš</button>
  <button class="key" data-key="(">(</button>

  <button class="key" data-key=")">)</button>
  <button class="key sc" data-key="pi">Ï€</button>
  <button class="key sc" data-key="e">e</button>
  <button class="key op" data-key="/">Ã·</button>
  <button class="key" data-key="7">7</button>
  <button class="key" data-key="8">8</button>

  <button class="key" data-key="9">9</button>
  <button class="key op" data-key="*">Ã—</button>
  <button class="key sc" data-key="pow">xÊ¸</button>
  <button class="key" data-key="4">4</button>
  <button class="key" data-key="5">5</button>
  <button class="key" data-key="6">6</button>

  <button class="key op" data-key="-">âˆ’</button>
  <button class="key" data-key="1">1</button>
  <button class="key" data-key="2">2</button>
  <button class="key" data-key="3">3</button>
  <button class="key sc" data-key="fact">n!</button>
  <button class="key" data-key="0">0</button>

  <button class="key" data-key=".">.</button>
  <button class="key wide op" data-key="+">+</button>
  <button class="key wide" data-key="=" style="background:linear-gradient(90deg,#10b981,#059669);color:#fff">=</button>
  <button class="key" data-key="C">C</button>
  <button class="key" data-key="DEL">âŒ«</button>
  <button class="key sc" data-key="inv">1/x</button>

  <!-- Scientific extra -->
  <button class="key sc" data-key="sin">sin</button>
  <button class="key sc" data-key="cos">cos</button>
  <button class="key sc" data-key="tan">tan</button>
  <button class="key sc" data-key="ln">ln</button>
  <button class="key sc" data-key="log">log</button>
  <button class="key" data-key="%">%</button>
</div>

<div class="history" id="history"></div>

<!-- BMI Calculator -->
<section class="bmi-card">
<h3>BMI Calculator</h3>
<div class="bmi-grid">
  <div><label>Age</label><input type="number" id="age" min="1"></div>
  <div><label>Gender</label><select id="gender"><option value="">Select</option><option value="male">Male</option><option value="female">Female</option></select></div>
  <div><label id="wLabel">Weight (kg)</label><input type="number" id="weight" step="0.1"></div>
  <div><label id="hLabel">Height (cm)</label><input type="number" id="height" step="0.1"></div>
</div>
<div style="margin-top:8px;">
  <button id="calcBmiBtn">Check BMI</button>
  <button id="copyBmi">Copy BMI</button>
</div>
<div class="bmi-bar"><div id="bmiFill" class="bmi-fill"></div></div>
<div id="bmiResult" class="small-muted" style="margin-top:4px;">Your BMI will appear here</div>
<div id="bmiAdvice" class="small-muted"></div>
</section>

<footer>EasyCalc Pro â€” Offline & Mobile-friendly.</footer>
</div>

<script>
// state
const state={expr:'',display:'0',mem:0,history:[],theme:'light'};

// update displays
function updateDisplays(){
  document.getElementById('smallExpr').textContent=state.expr||' ';
  document.getElementById('bigVal').textContent=state.display;
  renderHistory();
}
function renderHistory(){
  const h=document.getElementById('history');h.innerHTML='';
  state.history.slice(0,50).forEach(it=>{const d=document.createElement('div');d.textContent=it;h.appendChild(d);});
}

// calculator evaluation
function safeEval(s){
  if(!s)return 0;
  s=s.replace(/Ã—/g,'*').replace(/Ã·/g,'/').replace(/â€“|âˆ’/g,'-').replace(/\^/g,'**');
  s=s.replace(/\bpi\b/gi,Math.PI).replace(/\be\b/gi,Math.E);
  s=s.replace(/(\d+(\.\d+)?)!/g,'fact($1)').replace(/(\d+(\.\d+)?)%/g,'($1/100)');
  const func=`const fact=n=>{n=Math.floor(n);if(n<=1)return 1;let r=1;for(let i=2;i<=n;i++)r*=i;return r};return (${s});`;
  try{return Function(func)();}catch{return 'Error';}
}

// key press
function pressKey(k){
  if(k==='C'){state.expr='';state.display='0';updateDisplays();return;}
  if(k==='DEL'){state.expr=state.expr.slice(0,-1);updateDisplays();return;}
  if(k==='MC'){state.mem=0;updateDisplays();return;}
  if(k==='MR'){state.expr=state.mem;state.display=state.mem;updateDisplays();return;}
  if(k==='M+'){state.mem+=Number(state.display||0);updateDisplays();return;}
  if(k==='M-'){state.mem-=Number(state.display||0);updateDisplays();return;}
  if(k==='='){try{const r=safeEval(state.expr);state.display=r;state.history.unshift(`${state.expr}=${r}`);state.expr=String(r);updateDisplays();}catch{state.display='Error';updateDisplays();}return;}
  const funcs=['sin','cos','tan','ln','log','sqrt','pow','fact','inv','pi','e','%'];
  if(funcs.includes(k)){if(k==='pow')state.expr+='^';else if(k==='fact')state.expr+='!';else if(k==='inv')state.expr+='1/(';else if(k==='pi'||k==='e')state.expr+=k;else state.expr+=k+'(';updateDisplays();return;}
  state.expr+=k;updateDisplays();
}

// attach all keys
document.querySelectorAll('.key').forEach(b=>b.addEventListener('click',()=>pressKey(b.dataset.key)));

// theme toggle
document.getElementById('themeToggle').addEventListener('click',()=>{
  if(state.theme==='light'){state.theme='dark';document.body.classList.add('dark');}else{state.theme='light';document.body.classList.remove('dark');}
});

// keyboard support
document.addEventListener('keydown',e=>{
  if((e.key>='0'&&e.key<='9')||['+','-','*','/','.','(',')','%'].includes(e.key)){pressKey(e.key);e.preventDefault();}
  if(e.key==='Enter')pressKey('=');
  if(e.key==='Backspace')pressKey('DEL');
});

// BMI logic
document.getElementById('calcBmiBtn').addEventListener('click',()=>{
  let w=Number(document.getElementById('weight').value),h=Number(document.getElementById('height').value),age=Number(document.getElementById('age').value);
  let gender=document.getElementById('gender').value;
  if(!w||!h||!age||!gender)return alert('Fill all fields');
  const bmi=w/(h/100)**2;const rounded=Math.round(bmi*10)/10;
  let cat='',advice='';
  if(bmi<18.5){cat='Underweight';advice='Increase calories & nutrients';}
  else if(bmi<25){cat='Healthy';advice='Maintain diet & exercise';}
  else if(bmi<30){cat='Overweight';advice='Reduce calories & exercise';}
  else{cat='Obese';advice='Consult professional';}
  document.getElementById('bmiResult').textContent=`BMI: ${rounded} â€” ${cat}`;
  document.getElementById('bmiAdvice').textContent=advice;
  document.getElementById('bmiFill').style.width=Math.min(100,Math.max(0,(bmi-12)/(40-12)*100))+'%';
});

// initial update
updateDisplays();
</script>
</body>
</html>
